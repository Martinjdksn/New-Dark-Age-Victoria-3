
nda_effect_yigian_setup = {
		# Set Country Leader as Cultist if not already
		every_scope_character = {
			limit = { 
				is_ruler = yes 
				has_yigian_trait = no 
			}
			add_trait = nda_yig_master # need to add to heirs as well?
			change_character_religion = rel:nda_rel_yigian
		}

		# set state religion
		set_state_religion = rel:nda_rel_yigian
		# make recognized if not already
		set_country_type = recognized
		
		# set cult to be cultists and to be power brokers
		ig:ig_nda_cult_worshippers = {
			set_interest_group_name = ig_nda_yigian_church

			IF = {
				limit = { NOT = { has_modifier = nda_ig_secret_masters } }
				add_modifier = {
					name = nda_ig_secret_masters
				}
			}
		}

		# set (not so) secret goals - need to check they exist!
		IF = {
			limit = {
				exists = c:NEN
			}
			set_secret_goal = {
				country = c:NEN
				secret_goal = antagonize
			}			
		}
		IF = {
			limit = {
				exists = c:ELD
			}
			set_secret_goal = {
				country = c:ELD
				secret_goal = befriend
			}			
		}
		IF = {
			limit = {
				exists = c:DGN
			}
			set_secret_goal = {
				country = c:DGN
				secret_goal = befriend
			}			
		}


		set_strategy = ai_strategy_colonial_expansion
		set_strategy = ai_strategy_territorial_expansion
		set_strategy = ai_strategy_conservative_agenda
}

nda_effect_yigian_annex = {
	# annex a single country that openly supports YIG
	if = {
		limit = {
			exists = ROOT
			AND = {
				exists = c:YIG
				ROOT = c:YIG
			} 
			any_country = { 			
				NOT = {
					is_full_cult_country = { COUNTRY="THIS" }				
				}
				has_variable = nda_yig_in_open
			}
		} 

		ordered_country = {
			limit = {
				NOT = {
					is_full_cult_country = { COUNTRY="THIS" }	
					is_player = yes				
				}
				has_variable = nda_yig_in_open			
			}
			order_by = { subtract = global_country_ranking }
			position = 1

			save_scope_as = nda_yigian_annex			
		}

		# send notification - does country still exist after annex?
		post_notification = nda_yigian_lands_expand # toast

		annex = scope:nda_yigian_annex

		debug_log = "Yigian - Country surrenders."		
	}	
}