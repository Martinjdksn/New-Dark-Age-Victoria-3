je_nda_ritual_proceeds = {

	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	is_shown_when_inactive = {
		country_has_primary_culture = cu:nda_cul_cultist  
		exists = c:ELD
		c:ELD = ROOT
	}

	possible = {
	#	# ? has any state as Eldritch homeland - will convert to Yigian on completion
		# just ELD as initiator, DGN after a certain date, Other after a later date - others can assist via second journal
		country_has_primary_culture = cu:nda_cul_cultist # easy check

	#	OR = {
	#		AND = { # ELD should have first chance as initiator
	#			exists = c:ELD
	#			ELD = ROOT
	#		}
	#		AND = { # DGN should have a chance as initiator
	#			exists = c:DGN
	#			DGN = ROOT
	#		}
	#	}


 		NOT = { has_global_variable = nda_ritual_completed  }


	}

	immediate = {
		if = {
			limit = { NOT = { has_global_variable = je_nda_ritual_proceeds_tracker  } }

			set_global_variable = {
					name = je_nda_ritual_proceeds_tracker
					value = 1
				}
			clamp_global_variable = {
					name = je_nda_ritual_proceeds_tracker
					min = 0
					max = 500			
			}			
		}
		
		save_scope_as = nda_je_ritual_proceeds_scope
		
		debug_log = "Ritual Proceeds Journal : Started : "
	}

    complete = {
		custom_tooltip = {
			text = je_nda_ritual_proceeds_complete_tt
			scope:journal_entry = {
				is_goal_complete = yes
			}
		}
    }

	on_complete = {
		debug_log =  "Ritual Proceeds Journal : Completed :"

		set_global_variable = nda_ritual_completed
		trigger_event = { id = nda_ritual.3 }		
	}

	on_monthly_pulse = {
	
		# need better cont up
		effect = {
				scope:nda_je_ritual_proceeds_scope = {
					change_global_variable = {
						name = je_nda_ritual_proceeds_tracker
						add = 1
					}					
				}				
		}	
	
	}

	current_value = {
		#value = root.var:je_nda_ritual_proceeds_tracker
		value = global_var:je_nda_ritual_proceeds_tracker
	}

	goal_add_value = {
		add = 240 # 10 years at base rate
	}

    fail = {
		# if ritual failed or star alignment occured
    }
	
	on_fail = {
		# celebratory event?
	}

	progressbar = yes
	weight = 200

	#inheritable = yes

	should_be_pinned_by_default = yes
}

je_nda_ritual_assist = { # other countries should be able to help - this should be launched via decision??

	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	is_shown_when_inactive = {
		country_has_primary_culture = cu:nda_cul_cultist  
		exists = c:ELD
		NOT = { c:ELD = ROOT }
	}

	possible = {
	#	# ? has any state as Eldritch homeland - will convert to Yigian on completion
		# just ELD as initiator, DGN after a certain date, Other after a later date - others can assist via second journal
		country_has_primary_culture = cu:nda_cul_cultist # easy check

		has_global_variable = je_nda_ritual_proceeds_tracker
 		NOT = { has_global_variable = nda_ritual_completed  }


	}

	immediate = {
		if = {
			limit = { NOT = { has_global_variable = je_nda_ritual_proceeds_tracker  } }

			set_global_variable = {
					name = je_nda_ritual_proceeds_tracker
					value = 1
				}
			clamp_global_variable = {
					name = je_nda_ritual_proceeds_tracker
					min = 0
					max = 500			
			}			
		}
		
		save_scope_as = nda_je_ritual_proceeds_scope
		
		debug_log = "Ritual Assist Journal : Started : "
	}

    complete = {
		custom_tooltip = {
			text = je_nda_ritual_proceeds_complete_tt
			scope:journal_entry = {
				is_goal_complete = yes
			}
		}
    }

	on_complete = {
		debug_log =  "Ritual Assist Journal : Completed :"

		set_global_variable = nda_ritual_completed
		trigger_event = { id = nda_ritual.3 }		
	}

	on_monthly_pulse = {
	
		# need better cont up
		effect = {
				scope:nda_je_ritual_proceeds_scope = {
					change_global_variable = {
						name = je_nda_ritual_proceeds_tracker
						add = 1
					}					
				}				
		}	
	
	}

	current_value = {
		#value = root.var:je_nda_ritual_proceeds_tracker
		value = global_var:je_nda_ritual_proceeds_tracker
	}

	goal_add_value = {
		add = 240 # 10 years at base rate
	}

    fail = {
		# if ritual failed or star alignment occured
    }
	
	on_fail = {
		# celebratory event?
	}

	progressbar = yes
	weight = 200

	#inheritable = yes

	should_be_pinned_by_default = yes
}
